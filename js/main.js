(function(){var t,i,n,e;e=function(){function t(t,i){this.$rootEl=t,this.snapshot=i,this._render(),this._ui(),this._bind()}return t.prototype._render=function(){return this.ref=this.snapshot.ref(),this.data=this.snapshot.val(),this.$el=$("<li class='subscriptions-list-item'>\n  <a href='#' class='subscriptions-remove-button'>&times;</a> "+this.data.name+" — <a href='"+this.data.url+"' target='_blank'>"+this.data.url+"</a>\n</li>"),this.$rootEl.append(this.$el)},t.prototype._ui=function(){return this.$deleteBtn=this.$el.find(".subscriptions-remove-button")},t.prototype._bind=function(){return this.$deleteBtn.on("click",function(t){return function(i){return t.remove(),!1}}(this)),this.$deleteBtn.on("mouseenter",function(t){return $(t.currentTarget).parent().addClass("striked-out")}),this.$deleteBtn.on("mouseleave",function(t){return $(t.currentTarget).parent().removeClass("striked-out")})},t.prototype._unbind=function(){return this.$deleteBtn.off()},t.prototype.remove=function(){return confirm("Remove subscription?")?(this.ref.remove(),this.destroy()):void 0},t.prototype.destroy=function(){return this._unbind(),this.$el.remove()},t}(),n=function(){function t(t,i){this.$rootEl=t,this.firebase=i,this.subscriptionCollection=[],this._render(),this._ui(),this._bind()}return t.prototype._render=function(){return this.$rootEl.append("<section id='dash' style='display:none;'>\n  <p><span id='dash_email'></span> — <a id='dash_logout_btn' href='#'>logout</a></p>\n\n  <div id='subscriptions'>\n    <p>\n      <form id='subscriptions_new_form'>\n        <input id='subscriptions_new_name' placeholder='name' />\n        <input id='subscriptions_new_url' placeholder='rss feed link' type='url' />\n        <input id='subscriptions_new_submit' value='Add' type='submit' />\n      </form>\n    </p>\n    <ul id='subscriptions_list' class='subscriptions-list'></ul>\n  </div>\n</section>")},t.prototype._ui=function(){return this.$el=$("#dash"),this.$email=$("#dash_email"),this.$logoutBtn=$("#dash_logout_btn"),this.$newForm=$("#subscriptions_new_form"),this.$newUrl=$("#subscriptions_new_url"),this.$newName=$("#subscriptions_new_name"),this.$list=$("#subscriptions_list")},t.prototype.show=function(){return this.uid=app.user.uid,this.userEmail=app.user.email,this.$email.html(this.userEmail),this.subscriptionsRef=this.firebase.child("users").child(this.uid).child("subscriptions"),this.subscriptionsRef.on("child_added",function(t){return function(i){return t.subscriptionCollection.push(new e(t.$list,i))}}(this)),this.$el.show()},t.prototype.hide=function(){return $.each(this.subscriptionCollection,function(t,i){return i.destroy()}),this.subscriptionsRef.off(),delete this.uid,delete this.userEmail,delete this.subscriptionsRef,this.$el.hide()},t.prototype._bind=function(){return this.$logoutBtn.on("click",function(t){return app.authView.logout(),!1}),this.$newForm.on("submit",function(t){return function(i){return t.addNewSubscription(),!1}}(this))},t.prototype.addNewSubscription=function(){var t,i;return i=this.$newUrl.val(),this.$newUrl.val(""),t=this.$newName.val(),this.$newName.val(""),this.subscriptionsRef.push({url:i,name:t}),this.$newName.focus()},t}(),i=function(){function t(t,i,n){this.$rootEl=t,this.firebase=i,this.onAuthCb=n,this.usersRef=this.firebase.child("users"),this._render(),this._ui(),this._bind(),this._authenticate()}return t.prototype._render=function(){return this.$rootEl.append("<section id='auth' style='display:none;'>\n  <p>Welcome to <strong>RSS.rocks</strong>!</p>\n\n  <form id='auth_form'>\n    <input id='auth_email' value='' placeholder='email' type='email' required>\n    <input id='auth_password' value='' placeholder='password' type='password' required>\n    <input id='auth_submit' value='login' type='submit'>\n\n    <span id='auth_loading' style='display:none;'>please wait...</span>\n  </form>\n  <p id='auth_error' class='error'></p>\n  <p id='auth_signup_info'>— if you have an account, please <a id='auth_login_btn' href='#'>login</a></p>\n  <p id='auth_login_info'>— if you don't have an account, please <a id='auth_signup_btn' href='#'>signup</a><br>\n    — if you forgot your password, <a id='auth_reset_password' href='#'>reset</a> it via an email</p>\n</section>")},t.prototype._ui=function(){return this.$el=$("#auth"),this.$form=$("#auth_form"),this.$email=$("#auth_email"),this.$password=$("#auth_password"),this.$submitBtn=$("#auth_submit"),this.$loading=$("#auth_loading"),this.$error=$("#auth_error"),this.$loginBtn=$("#auth_login_btn"),this.$signupBtn=$("#auth_signup_btn"),this.$resetBtn=$("#auth_reset_password"),this.$loginInfo=$("#auth_login_info"),this.$signupInfo=$("#auth_signup_info")},t.prototype._bind=function(){return this.$loginBtn.on("click",function(t){return function(i){return t.showLogin(),!1}}(this)),this.$signupBtn.on("click",function(t){return function(i){return t.showSignup(),!1}}(this)),this.$resetBtn.on("click",function(t){return function(i){return t.resetPassword(),!1}}(this)),this.$form.on("submit",function(t){return function(i){return t.formSubmitCallback(),!1}}(this))},t.prototype._authenticate=function(){return this.auth=new FirebaseSimpleLogin(this.firebase,function(t){return function(i,n){return t.$loading.hide(),n?"function"==typeof t.onAuthCb&&t.onAuthCb(n):app.show(t),i?t.error(i.message.replace("FirebaseSimpleLogin: ","")):void 0}}(this))},t.prototype.signup=function(){var t,i;return t=this.$email.val(),i=this.$password.val(),this.$loading.show(),this.auth.createUser(t,i,function(t){return function(i,n){return t.$loading.hide(),i?t.error(i.message.replace("FirebaseSimpleLogin: ","")):(t.usersRef.child(n.uid).child("email").set(n.email),"function"==typeof t.onAuthCb?t.onAuthCb(n):void 0)}}(this))},t.prototype.login=function(){return this.$loading.show(),this.auth.login("password",{email:this.$email.val(),password:this.$password.val(),rememberMe:!0})},t.prototype.show=function(){return this.showLogin(),this.$el.show(),this.$email.focus()},t.prototype.hide=function(){return this.$el.hide()},t.prototype.showLogin=function(){return this.formSubmitCallback=this.login,this.$submitBtn.val("login"),this.$loginInfo.show(),this.$signupInfo.hide(),this.$error.html("")},t.prototype.showSignup=function(){return this.formSubmitCallback=this.signup,this.$submitBtn.val("signup"),this.$signupInfo.show(),this.$loginInfo.hide(),this.$error.html("")},t.prototype.logout=function(){return this.auth.logout(),delete app.user,this.$email.val(""),this.$password.val(""),this.$error.html(""),app.show(this)},t.prototype.error=function(t){return this.$error.html(t)},t.prototype.resetPassword=function(){},t}(),t=function(){function t(t){this.firebaseAppName=t,this.firebase=new Firebase("https://"+this.firebaseAppName+".firebaseio.com"),this.ui(),this.render()}return t.prototype.ui=function(){return this.$el=$("#app")},t.prototype.render=function(){return this.dashView=new n(this.$el,this.firebase),this.authView=new i(this.$el,this.firebase,function(t){return function(i){return t.user=i,t.show(t.dashView)}}(this))},t.prototype.show=function(t){var i;return null!=(i=this.currentView)&&i.hide(),this.currentView=t,this.currentView.show()},t}(),$(function(){var i;return i="rss-rocks",window.app=new t(i)})}).call(this);
//# sourceMappingURL=./main.map